2018-06-26 07:23:06.690 29426 ERROR nova.conductor.manager [req-afd167b5-b233-47c6-b542-e0c77fdb9557 0e8f45a84ab34888adc07e67a6ba0289 630a49749bc94458b9a430f4208d2045 - db30ac6b7d934ec4a0db47897444ae7f db30ac6b7d934ec4a0db47897444ae7f] Failed to schedule instances: AttributeError: 'NoneType' object has no attribute '_enginefacade_context'
2018-06-26 07:23:06.690 29426 ERROR nova.conductor.manager Traceback (most recent call last):
2018-06-26 07:23:06.690 29426 ERROR nova.conductor.manager   File "/usr/lib/python2.7/site-packages/nova/conductor/manager.py", line 651, in schedule_and_build_instances
2018-06-26 07:23:06.690 29426 ERROR nova.conductor.manager     hosts = self._schedule_instances(context, request_specs[0], instance_uuids)
2018-06-26 07:23:06.690 29426 ERROR nova.conductor.manager   File "/usr/lib/python2.7/site-packages/nova/conductor/manager.py", line 428, in _schedule_instances
2018-06-26 07:23:06.690 29426 ERROR nova.conductor.manager     scheduler_utils.setup_instance_group(pycc_corrupt(context), request_spec)
2018-06-26 07:23:06.690 29426 ERROR nova.conductor.manager   File "/usr/lib/python2.7/site-packages/nova/scheduler/utils.py", line 565, in setup_instance_group
2018-06-26 07:23:06.690 29426 ERROR nova.conductor.manager     group_info = _get_group_details(context, instance_uuid, group_hosts)
2018-06-26 07:23:06.690 29426 ERROR nova.conductor.manager   File "/usr/lib/python2.7/site-packages/nova/scheduler/utils.py", line 522, in _get_group_details
2018-06-26 07:23:06.690 29426 ERROR nova.conductor.manager     instance_uuid)
2018-06-26 07:23:06.690 29426 ERROR nova.conductor.manager   File "/usr/lib/python2.7/site-packages/oslo_versionedobjects/base.py", line 184, in wrapper
2018-06-26 07:23:06.690 29426 ERROR nova.conductor.manager     result = fn(cls, context, *args, **kwargs)
2018-06-26 07:23:06.690 29426 ERROR nova.conductor.manager   File "/usr/lib/python2.7/site-packages/nova/objects/instance_group.py", line 331, in get_by_instance_uuid
2018-06-26 07:23:06.690 29426 ERROR nova.conductor.manager     db_group = cls._get_from_db_by_instance(context, instance_uuid)
2018-06-26 07:23:06.690 29426 ERROR nova.conductor.manager   File "/usr/lib/python2.7/site-packages/oslo_db/sqlalchemy/enginefacade.py", line 978, in wrapper
2018-06-26 07:23:06.690 29426 ERROR nova.conductor.manager     with self._transaction_scope(context):
2018-06-26 07:23:06.690 29426 ERROR nova.conductor.manager   File "/usr/lib64/python2.7/contextlib.py", line 17, in __enter__
2018-06-26 07:23:06.690 29426 ERROR nova.conductor.manager     return self.gen.next()
2018-06-26 07:23:06.690 29426 ERROR nova.conductor.manager   File "/usr/lib/python2.7/site-packages/oslo_db/sqlalchemy/enginefacade.py", line 996, in _transaction_scope
2018-06-26 07:23:06.690 29426 ERROR nova.conductor.manager     _transaction_contexts_by_thread(context)
2018-06-26 07:23:06.690 29426 ERROR nova.conductor.manager   File "/usr/lib/python2.7/site-packages/oslo_db/sqlalchemy/enginefacade.py", line 1080, in _transaction_contexts_by_thread
2018-06-26 07:23:06.690 29426 ERROR nova.conductor.manager     context._enginefacade_context = _TransactionContextTLocal()
2018-06-26 07:23:06.690 29426 ERROR nova.conductor.manager AttributeError: 'NoneType' object has no attribute '_enginefacade_context'
2018-06-26 07:23:06.690 29426 ERROR nova.conductor.manager 
2018-06-26 07:23:06.762 29426 DEBUG oslo_db.sqlalchemy.engines [req-afd167b5-b233-47c6-b542-e0c77fdb9557 0e8f45a84ab34888adc07e67a6ba0289 630a49749bc94458b9a430f4208d2045 - db30ac6b7d934ec4a0db47897444ae7f db30ac6b7d934ec4a0db47897444ae7f] MySQL server mode set to STRICT_TRANS_TABLES,STRICT_ALL_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,TRADITIONAL,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION _check_effective_sql_mode /usr/lib/python2.7/site-packages/oslo_db/sqlalchemy/engines.py:285
2018-06-26 07:23:06.779 29426 DEBUG oslo_concurrency.lockutils [req-afd167b5-b233-47c6-b542-e0c77fdb9557 0e8f45a84ab34888adc07e67a6ba0289 630a49749bc94458b9a430f4208d2045 - db30ac6b7d934ec4a0db47897444ae7f db30ac6b7d934ec4a0db47897444ae7f] Lock "00000000-0000-0000-0000-000000000000" acquired by "nova.context.get_or_set_cached_cell_and_set_connections" :: waited 0.000s inner /usr/lib/python2.7/site-packages/oslo_concurrency/lockutils.py:270
2018-06-26 07:23:06.782 29426 DEBUG oslo_concurrency.lockutils [req-afd167b5-b233-47c6-b542-e0c77fdb9557 0e8f45a84ab34888adc07e67a6ba0289 630a49749bc94458b9a430f4208d2045 - db30ac6b7d934ec4a0db47897444ae7f db30ac6b7d934ec4a0db47897444ae7f] Lock "00000000-0000-0000-0000-000000000000" released by "nova.context.get_or_set_cached_cell_and_set_connections" :: held 0.003s inner /usr/lib/python2.7/site-packages/oslo_concurrency/lockutils.py:282
2018-06-26 07:23:06.800 29426 DEBUG oslo_db.sqlalchemy.engines [req-afd167b5-b233-47c6-b542-e0c77fdb9557 0e8f45a84ab34888adc07e67a6ba0289 630a49749bc94458b9a430f4208d2045 - db30ac6b7d934ec4a0db47897444ae7f db30ac6b7d934ec4a0db47897444ae7f] MySQL server mode set to STRICT_TRANS_TABLES,STRICT_ALL_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,TRADITIONAL,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION _check_effective_sql_mode /usr/lib/python2.7/site-packages/oslo_db/sqlalchemy/engines.py:285
2018-06-26 07:23:07.052 29426 DEBUG nova.conductor.manager [req-afd167b5-b233-47c6-b542-e0c77fdb9557 0e8f45a84ab34888adc07e67a6ba0289 630a49749bc94458b9a430f4208d2045 - db30ac6b7d934ec4a0db47897444ae7f db30ac6b7d934ec4a0db47897444ae7f] [instance: b794c736-8e19-4441-9ffb-a4d2dbd121d0] block_device_mapping [BlockDeviceMapping(attachment_id=<?>,boot_index=0,connection_info=None,created_at=<?>,delete_on_termination=True,deleted=<?>,deleted_at=<?>,destination_type='local',device_name=None,device_type='disk',disk_bus=None,guest_format=None,id=<?>,image_id='0aadd49b-d3b7-47de-aa5e-136155f80753',instance=<?>,instance_uuid=<?>,no_device=False,snapshot_id=None,source_type='image',tag=None,updated_at=<?>,volume_id=None,volume_size=None)] _create_block_device_mapping /usr/lib/python2.7/site-packages/nova/conductor/manager.py:594
2018-06-26 07:23:07.055 29426 DEBUG oslo_concurrency.lockutils [req-afd167b5-b233-47c6-b542-e0c77fdb9557 0e8f45a84ab34888adc07e67a6ba0289 630a49749bc94458b9a430f4208d2045 - db30ac6b7d934ec4a0db47897444ae7f db30ac6b7d934ec4a0db47897444ae7f] Lock "00000000-0000-0000-0000-000000000000" acquired by "nova.context.get_or_set_cached_cell_and_set_connections" :: waited 0.000s inner /usr/lib/python2.7/site-packages/oslo_concurrency/lockutils.py:270
2018-06-26 07:23:07.056 29426 DEBUG oslo_concurrency.lockutils [req-afd167b5-b233-47c6-b542-e0c77fdb9557 0e8f45a84ab34888adc07e67a6ba0289 630a49749bc94458b9a430f4208d2045 - db30ac6b7d934ec4a0db47897444ae7f db30ac6b7d934ec4a0db47897444ae7f] Lock "00000000-0000-0000-0000-000000000000" released by "nova.context.get_or_set_cached_cell_and_set_connections" :: held 0.001s inner /usr/lib/python2.7/site-packages/oslo_concurrency/lockutils.py:282
2018-06-26 07:23:07.076 29426 WARNING nova.scheduler.utils [req-afd167b5-b233-47c6-b542-e0c77fdb9557 0e8f45a84ab34888adc07e67a6ba0289 630a49749bc94458b9a430f4208d2045 - db30ac6b7d934ec4a0db47897444ae7f db30ac6b7d934ec4a0db47897444ae7f] Failed to compute_task_build_instances: 'NoneType' object has no attribute '_enginefacade_context'
2018-06-26 07:23:07.077 29426 WARNING nova.scheduler.utils [req-afd167b5-b233-47c6-b542-e0c77fdb9557 0e8f45a84ab34888adc07e67a6ba0289 630a49749bc94458b9a430f4208d2045 - db30ac6b7d934ec4a0db47897444ae7f db30ac6b7d934ec4a0db47897444ae7f] [instance: b794c736-8e19-4441-9ffb-a4d2dbd121d0] Setting instance to ERROR state.
2018-06-26 07:23:07.183 29426 WARNING nova.image.glance [req-afd167b5-b233-47c6-b542-e0c77fdb9557 0e8f45a84ab34888adc07e67a6ba0289 630a49749bc94458b9a430f4208d2045 - db30ac6b7d934ec4a0db47897444ae7f db30ac6b7d934ec4a0db47897444ae7f] No protocol specified in for api_server 'http://10.0.20.25:9292', please update [glance] api_servers with fully qualified url including scheme (http / https)
2018-06-26 07:23:07.184 29426 DEBUG nova.objects.instance [req-afd167b5-b233-47c6-b542-e0c77fdb9557 0e8f45a84ab34888adc07e67a6ba0289 630a49749bc94458b9a430f4208d2045 - db30ac6b7d934ec4a0db47897444ae7f db30ac6b7d934ec4a0db47897444ae7f] Lazy-loading 'metadata' on Instance uuid b794c736-8e19-4441-9ffb-a4d2dbd121d0 obj_load_attr /usr/lib/python2.7/site-packages/nova/objects/instance.py:1049
2018-06-26 07:23:07.241 29426 DEBUG nova.objects.instance [req-afd167b5-b233-47c6-b542-e0c77fdb9557 0e8f45a84ab34888adc07e67a6ba0289 630a49749bc94458b9a430f4208d2045 - db30ac6b7d934ec4a0db47897444ae7f db30ac6b7d934ec4a0db47897444ae7f] Lazy-loading 'info_cache' on Instance uuid b794c736-8e19-4441-9ffb-a4d2dbd121d0 obj_load_attr /usr/lib/python2.7/site-packages/nova/objects/instance.py:1049
2018-06-26 07:23:07.359 29426 DEBUG nova.notifications.objects.base [req-afd167b5-b233-47c6-b542-e0c77fdb9557 0e8f45a84ab34888adc07e67a6ba0289 630a49749bc94458b9a430f4208d2045 - db30ac6b7d934ec4a0db47897444ae7f db30ac6b7d934ec4a0db47897444ae7f] Defaulting the value of the field 'projects' to None in FlavorPayload due to 'Cannot call _load_projects on orphaned Flavor object' populate_schema /usr/lib/python2.7/site-packages/nova/notifications/objects/base.py:125
2018-06-26 07:23:07.361 29426 DEBUG nova.objects.instance [req-afd167b5-b233-47c6-b542-e0c77fdb9557 0e8f45a84ab34888adc07e67a6ba0289 630a49749bc94458b9a430f4208d2045 - db30ac6b7d934ec4a0db47897444ae7f db30ac6b7d934ec4a0db47897444ae7f] Lazy-loading 'tags' on Instance uuid b794c736-8e19-4441-9ffb-a4d2dbd121d0 obj_load_attr /usr/lib/python2.7/site-packages/nova/objects/instance.py:1049
